<!DOCTYPE html>
<html>
	<head>
    <link rel="stylesheet" href="bootstrap.min.css"/>
    <style>
      body {
        margin-top: 50px;
      }
      th,td {
        text-align: left;
      }
      th:last-child, td:last-child {
        text-align: right;
      }
    </style>
	</head>	
	<body>
		<div class="container">
      <h1>Companybook Services</h1>
      <table id="services" class="table table-striped"></table>
		</div>

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.8.0/jquery.min.js"></script>

    <script>
      function update() {
        $.getJSON('index.json', function(services) {
          content = '<tr><th>Name</th><th>Instances</th></tr>';

          services.map(function(service) {
            service.versions.map(function(version) {
              summary = '';

              version.instances.map(function(instance) {
                summary += instance.endpoint + '\n';
              });

              content += '<tr><td>' + 
                  service.name + ' ' + 
                  version.number + '</td><td>' + 
                  version.instances.length + '</td></tr>';
            })
          });

          $('#services').html(content);
        });
      }

      $(document).ready(function(){
        update();
      });
    </script>
	</body>
</html>
